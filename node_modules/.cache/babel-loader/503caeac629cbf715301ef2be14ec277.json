{"ast":null,"code":"import _toConsumableArray from\"A:/WorkPorjects/Skill Box/greencosmicStudy/Frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"A:/WorkPorjects/Skill Box/greencosmicStudy/Frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import style from\"./CoursesSteps.module.css\";import React,{useEffect,useState}from\"react\";import $api from\"../../../../Http\";import Text from\"./Types/Text\";import Video from\"./Types/Video\";import Img from\"./Types/Img\";import Button from\"./Types/Button.jsx\";import Test from\"./Types/Test\";import queryString,{parse}from\"query-string\";import{useHistory}from\"react-router-dom\";import changeStepsArray from\"./setSteps.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function CoursesSteps(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),currentStep=_useState2[0],setCurrentStep=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),currentPage=_useState4[0],setCurrentPage=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),initialEffect=_useState6[0],setInitialEffect=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),changes=_useState8[0],setChanges=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),button=_useState10[0],_setButton=_useState10[1];var _useState11=useState(true),_useState12=_slicedToArray(_useState11,2),initialPath=_useState12[0],setInitialPath=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),block=_useState14[0],setBlock=_useState14[1];var totalCount=props.steps.length;var history=useHistory();useEffect(function(){if(initialPath&&!initialEffect){var parsed=queryString.parse(history.location.search);$api.post(\"/course/lessons\",{courseName:parsed.course_name}).then(function(response){console.log(response);props.setLessons(response.data.lessons);});props.setCurrentCourseName(parsed.course_name);props.setCurrentLessonName(parsed.lesson_name);if(parsed.course_name!==\"\"&&parsed.lesson_name!==\"\"&&props.auth){changeStepsArray(parsed.course_name,parsed.lesson_name);setInitialPath(false);}}},[props.auth,initialEffect,changes]);useEffect(function(){if(props.currentCourseName&&props.currentLessonName){var parsed=queryString.parse(history.location.search);if(parsed.course_name!==props.currentCourseName||parsed.lesson_name!==props.currentLessonName){setInitialPath(false);setChanges(changes+1);setCurrentStep([]);setCurrentPage(0);setBlock(false);}history.push({pathname:\"/courses/lessons/steps\",search:\"?course_name=\"+props.currentCourseName+\"&lesson_name=\"+props.currentLessonName});}setInitialPath(true);setInitialEffect(false);},[props.auth,props.currentLessonName]);useEffect(function(){if(props.steps.length>0&&currentStep.length<totalCount){var _props$steps$currentP;var search=history.location.search;var parsed=queryString.parse(search);$api.post(\"/course/one-step\",{courseName:parsed.course_name,lessonName:parsed.lesson_name,stepName:(_props$steps$currentP=props.steps[currentPage])===null||_props$steps$currentP===void 0?void 0:_props$steps$currentP.stepName}).then(function(response){var error=false;if(response.data.message){error=true;}var i=0;currentStep.map(function(step){if(step.stepName===response.data.stepName&&response.data.stepName){i++;}return step;});if(i===0&&!error){setCurrentStep([].concat(_toConsumableArray(currentStep),[response.data]));setCurrentPage(function(prevState){return prevState+1;});}}).catch(function(error){console.log(error);});}});return/*#__PURE__*/_jsx(\"div\",{className:style.container,children:/*#__PURE__*/_jsxs(\"div\",{id:\"content\",children:[currentStep.map(function(step,index){if(step.stepType===\"Test\"){return/*#__PURE__*/_jsx(Test,{stepName:step.stepName,stepContent:step.stepContent,setBlock:setBlock},index);}if(step.stepType===\"Img\"){return/*#__PURE__*/_jsx(Img,{stepName:step.stepName,stepContent:step.stepContent},index);}if(step.stepType===\"Text\"){return/*#__PURE__*/_jsx(Text,{stepName:step.stepName,stepContent:step.stepContent},index);}if(step.stepType===\"Video\"){return/*#__PURE__*/_jsx(Video,{stepName:step.stepName,stepContent:step.stepContent},index);}return step;}),totalCount!==0&&(totalCount===currentPage||totalCount<currentPage)&&!button&&!block?/*#__PURE__*/_jsx(Button,{onPageChanged:props.onPageChanged,setButton:function setButton(){return _setButton;}}):/*#__PURE__*/_jsx(\"div\",{})]})});}export default CoursesSteps;","map":{"version":3,"sources":["A:/WorkPorjects/Skill Box/greencosmicStudy/Frontend/src/Components/Courses/CoursesMenu/CoursesPersonal/CoursesSteps.jsx"],"names":["style","React","useEffect","useState","$api","Text","Video","Img","Button","Test","queryString","parse","useHistory","changeStepsArray","CoursesSteps","props","currentStep","setCurrentStep","currentPage","setCurrentPage","initialEffect","setInitialEffect","changes","setChanges","button","setButton","initialPath","setInitialPath","block","setBlock","totalCount","steps","length","history","parsed","location","search","post","courseName","course_name","then","response","console","log","setLessons","data","lessons","setCurrentCourseName","setCurrentLessonName","lesson_name","auth","currentCourseName","currentLessonName","push","pathname","lessonName","stepName","error","message","i","map","step","prevState","catch","container","index","stepType","stepContent","onPageChanged"],"mappings":"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","sourcesContent":["import style from \"./CoursesSteps.module.css\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport $api from \"../../../../Http\";\r\nimport Text from \"./Types/Text\";\r\nimport Video from \"./Types/Video\";\r\nimport Img from \"./Types/Img\";\r\nimport Button from \"./Types/Button.jsx\";\r\nimport Test from \"./Types/Test\";\r\nimport queryString, { parse } from \"query-string\";\r\n\r\nimport { useHistory } from \"react-router-dom\";\r\nimport changeStepsArray from \"./setSteps.js\";\r\n\r\nfunction CoursesSteps(props) {\r\n  const [currentStep, setCurrentStep] = useState([]);\r\n  const [currentPage, setCurrentPage] = useState(0);\r\n  const [initialEffect, setInitialEffect] = useState(true);\r\n  const [changes, setChanges] = useState(0);\r\n  const [button, setButton] = useState(false);\r\n  const [initialPath, setInitialPath] = useState(true);\r\n  const [block, setBlock] = useState(false);\r\n\r\n  const totalCount = props.steps.length;\r\n  const history = useHistory();\r\n\r\n  useEffect(() => {\r\n    if (initialPath && !initialEffect) {\r\n      const parsed = queryString.parse(history.location.search);\r\n      $api\r\n        .post(\"/course/lessons\", { courseName: parsed.course_name })\r\n        .then((response) => {\r\n          console.log(response);\r\n          props.setLessons(response.data.lessons);\r\n        });\r\n      props.setCurrentCourseName(parsed.course_name);\r\n      props.setCurrentLessonName(parsed.lesson_name);\r\n\r\n      if (\r\n        parsed.course_name !== \"\" &&\r\n        parsed.lesson_name !== \"\" &&\r\n        props.auth\r\n      ) {\r\n        changeStepsArray(parsed.course_name, parsed.lesson_name);\r\n        setInitialPath(false);\r\n      }\r\n    }\r\n  }, [props.auth, initialEffect, changes]);\r\n\r\n  useEffect(() => {\r\n    if (props.currentCourseName && props.currentLessonName) {\r\n      const parsed = queryString.parse(history.location.search);\r\n      if (\r\n        parsed.course_name !== props.currentCourseName ||\r\n        parsed.lesson_name !== props.currentLessonName\r\n      ) {\r\n        setInitialPath(false);\r\n        setChanges(changes + 1);\r\n        setCurrentStep([]);\r\n        setCurrentPage(0);\r\n        setBlock(false);\r\n      }\r\n      history.push({\r\n        pathname: \"/courses/lessons/steps\",\r\n        search:\r\n          \"?course_name=\" +\r\n          props.currentCourseName +\r\n          \"&lesson_name=\" +\r\n          props.currentLessonName,\r\n      });\r\n    }\r\n    setInitialPath(true);\r\n    setInitialEffect(false);\r\n  }, [props.auth, props.currentLessonName]);\r\n\r\n  useEffect(() => {\r\n    if (props.steps.length > 0 && currentStep.length < totalCount) {\r\n      const { search } = history.location;\r\n      const parsed = queryString.parse(search);\r\n\r\n      $api\r\n        .post(\"/course/one-step\", {\r\n          courseName: parsed.course_name,\r\n          lessonName: parsed.lesson_name,\r\n          stepName: props.steps[currentPage]?.stepName,\r\n        })\r\n        .then((response) => {\r\n          let error = false;\r\n          if (response.data.message) {\r\n            error = true;\r\n          }\r\n\r\n          let i = 0;\r\n\r\n          currentStep.map((step) => {\r\n            if (\r\n              step.stepName === response.data.stepName &&\r\n              response.data.stepName\r\n            ) {\r\n              i++;\r\n            }\r\n            return step;\r\n          });\r\n\r\n          if (i === 0 && !error) {\r\n            setCurrentStep([...currentStep, response.data]);\r\n            setCurrentPage((prevState) => prevState + 1);\r\n          }\r\n        })\r\n        .catch((error) => {\r\n          console.log(error);\r\n        });\r\n    }\r\n  });\r\n\r\n  return (\r\n    <div className={style.container}>\r\n      <div id=\"content\">\r\n        {currentStep.map((step, index) => {\r\n          if (step.stepType === \"Test\") {\r\n            return (\r\n              <Test\r\n                key={index}\r\n                stepName={step.stepName}\r\n                stepContent={step.stepContent}\r\n                setBlock={setBlock}\r\n              />\r\n            );\r\n          }\r\n          if (step.stepType === \"Img\") {\r\n            return (\r\n              <Img\r\n                key={index}\r\n                stepName={step.stepName}\r\n                stepContent={step.stepContent}\r\n              />\r\n            );\r\n          }\r\n          if (step.stepType === \"Text\") {\r\n            return (\r\n              <Text\r\n                key={index}\r\n                stepName={step.stepName}\r\n                stepContent={step.stepContent}\r\n              />\r\n            );\r\n          }\r\n          if (step.stepType === \"Video\") {\r\n            return (\r\n              <Video\r\n                key={index}\r\n                stepName={step.stepName}\r\n                stepContent={step.stepContent}\r\n              />\r\n            );\r\n          }\r\n\r\n          return step;\r\n        })}\r\n        {totalCount !== 0 &&\r\n        (totalCount === currentPage || totalCount < currentPage) &&\r\n        !button &&\r\n        !block ? (\r\n          <Button\r\n            onPageChanged={props.onPageChanged}\r\n            setButton={() => setButton}\r\n          />\r\n        ) : (\r\n          <div></div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\nexport default CoursesSteps;\r\n"]},"metadata":{},"sourceType":"module"}